---
title: "Final Project (Group 2)"
author: "Group 2"
date: "`r Sys.Date()`"
documentclass: article
geometry: margin=1in
fontsize: 11pt
output:
  pdf_document:
    toc: false
    df_print: kable
    fig_caption: false
    number_sections: false
    dev: pdf
    highlight: tango
  html_document:
    theme: default
    self_contained: true
    toc: false
    df_print: kable
    fig_caption: false
    number_sections: false
    smart: true
    dev: svg
---

```{r setup, include = FALSE}
# DO NOT ALTER THIS CHUNK
knitr::opts_chunk$set(
  echo = TRUE,
  eval = TRUE,
  fig.width = 5,
  fig.asp = 0.618,
  out.width = "70%",
  dpi = 120,
  fig.align = "center",
  cache = FALSE
)
is_pdf <- try (("pdf_document" %in% 
                  rmarkdown::all_output_formats(knitr::current_input())), 
               silent=TRUE)
is_pdf <- (is_pdf == TRUE)

# Load required packages
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(broom))
suppressPackageStartupMessages(library(modelr))
suppressPackageStartupMessages(library(plotly))
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(infer))
suppressPackageStartupMessages(library(lubridate))
suppressPackageStartupMessages(library(geosphere))
suppressPackageStartupMessages(library(lubridate))
suppressPackageStartupMessages(library(infer))
suppressPackageStartupMessages(library(usmap))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(formattable))
suppressPackageStartupMessages(library(plotrix))
suppressPackageStartupMessages(library(ggpubr))
suppressPackageStartupMessages(library(boot))
```

* Research Question/Hypothesis: 
What variable in the world happiness report (family, health, trust, generosity, and economics) has the greatest effect on a nation’s happiness score? 

* Hypothesis: Economics plays the largest role in a nation’s happiness score. 



```{r}
library(readxl)
library(dplyr)
library(ggplot2)
library(tidyr)

data <- read_excel("WHR_2015.xlsx")

colnames(data)
```
```{r}
library(readxl)

data <- read_excel("WHR_2015.xlsx")

print(colnames(data))

data <- data %>%
  rename(
    Economy = `Economy (GDP per Capita)`,  
    Family = 'Family',                      
    Health = `Health (Life Expectancy)`,
    Trust = `Trust (Government Corruption)`,  
    Generosity = 'Generosity', 
    Happiness_Score = `Happiness Score`
  )
print(colnames(data))

```

```{r}
  head(
    select(data, Economy, Family, Health, Trust, Generosity, Happiness_Score)
  )
```


```{r}
# colnames(data) <- c("Country", "Region", "Happiness Score",
#                    "Happiness Rank","Economy",
#                    "Health", "Freedom", 
#                    "Trust", "Family", "Generosity", 
#                    "Dystopia Residual", "Standard Error") 

#print(colnames(selected_data))
#print(head(selected_data))
```



[ Module 4: Eugene Kim - Explanatory Data Analysis ] 

```{r}
str(data)
head(data)
tail(data)
```

```{r}
library(tidyr)
library(dplyr) 

happiness_long <- data %>%
  pivot_longer(
    cols = c(`Economy`, `Family`, `Health`, `Trust`, `Generosity`),
    names_to = "Variable",
    values_to = "Value"
  )

```

```{r}
library(ggplot2)

ggplot(happiness_long, aes(x = Variable, y = Value, fill = Variable)) +
  geom_boxplot(alpha = 0.6) +  
  labs(title = "Impact of Various Factors on Happiness Score",
       subtitle = "Boxplot representation of various factors influencing happiness",
       x = "Factors Influencing Happiness",
       y = "Happiness Score") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 10, hjust = 1),  
        legend.position = "none")  

```

```{r}
library(ggplot2)

ggplot(happiness_long, aes(x = Variable, y = Value, fill = Variable)) +
  geom_violin(trim = TRUE, alpha = 0.6) +  
  labs(title = "Impact of Various Factors on Happiness Score",
       subtitle = "Violin plots representing distribution of happiness factors",
       x = "Factors",
       y = "Happiness Score") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 10, hjust = 0.65, vjust = 1),  
        legend.position = "none")  

```










