---
title: "Final Project (Group 2)"
author: "Group 2"
date: "`r Sys.Date()`"
documentclass: article
geometry: margin=1in
fontsize: 11pt
output:
  pdf_document:
    toc: false
    df_print: kable
    fig_caption: false
    number_sections: false
    dev: pdf
    highlight: tango
  html_document:
    theme: default
    self_contained: true
    toc: false
    df_print: kable
    fig_caption: false
    number_sections: false
    smart: true
    dev: svg
---
```{r setup, include = FALSE}
# DO NOT ALTER THIS CHUNK
knitr::opts_chunk$set(
  echo = TRUE,
  eval = TRUE,
  fig.width = 5,
  fig.asp = 0.618,
  out.width = "70%",
  dpi = 120,
  fig.align = "center",
  cache = FALSE
)
is_pdf <- try (("pdf_document" %in% 
                  rmarkdown::all_output_formats(knitr::current_input())), 
               silent=TRUE)
is_pdf <- (is_pdf == TRUE)

# Load required packages
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(broom))
suppressPackageStartupMessages(library(modelr))
suppressPackageStartupMessages(library(plotly))
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(infer))
suppressPackageStartupMessages(library(lubridate))
suppressPackageStartupMessages(library(geosphere))
suppressPackageStartupMessages(library(lubridate))
suppressPackageStartupMessages(library(infer))
suppressPackageStartupMessages(library(usmap))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(formattable))
suppressPackageStartupMessages(library(plotrix))
suppressPackageStartupMessages(library(ggpubr))
suppressPackageStartupMessages(library(boot))
```

* Research Question/Hypothesis: 
What variable in the world happiness report (family, health, trust, generosity, and economics) has the greatest effect on a nation’s happiness score? 

* Hypothesis: Economics plays the largest role in a nation’s happiness score. 

```{r}
library(readxl)
library(dplyr)
library(ggplot2)
library(tidyr)

data <- read_excel("2019.xls")

colnames(data)
```

```{r}
library(readxl)

data <- read_excel("2019.xls")

print(colnames(data))

data <- data %>%
  rename(
    Economy = `GDP per capita`,  
    Social = 'Social support',                      
    Health = `Healthy life expectancy`,
    Freedom = `Freedom to make life choices`,  
    Corruption = 'Perceptions of corruption', 
    Happiness_Score = `Score`
  )
print(colnames(data))

```

```{r}
  head(
    select(data, Economy, Social, Health, Freedom, Corruption, Happiness_Score)
  )
```

[Module 2: Junhyung Kim, Jiho Lee]

```{r}
data %>%
ggplot() +
geom_point(mapping = aes (x = Economy, y= Happiness_Score)) +
labs(title = 
       "Scatter Plot of Relationship Between Economy and Happiness Score",
x = "Economy", y = "Happiness Score")
```
```{r}
data %>%
ggplot() +
geom_point(mapping = aes (x = Social, y= Happiness_Score)) +
labs(title = 
       "Scatter Plot of Relationship Between Social and Happiness Score",
x = "Social", y = "Happiness Score")
```
```{r}
data %>%
ggplot() +
geom_point(mapping = aes (x = Health, y= Happiness_Score)) +
labs(title = 
       "Scatter Plot of Relationship Between Health and Happiness Score",
x = "Health", y = "Happiness Score")
```

```{r}
data %>%
ggplot() +
geom_point(mapping = aes (x = Freedom, y= Happiness_Score)) +
labs(title = 
       "Scatter Plot of Relationship Between
        Freedom and Happiness Score",
x = "Freedom", y = "Happiness Score")
```

```{r}
data %>%
ggplot() +
geom_point(mapping = aes (x = Corruption, y= Happiness_Score)) +
labs(title = 
       "Scatter Plot of Relationship Between 
        Corruption and Happiness Score",
x = "Corruption", y = "Happiness Score")
```

[ Module 4: Eugene Kim,  - Explanatory Data Analysis ] 

```{r}
str(data)
head(
    select(data, Economy, Social, Health, Freedom, Corruption, Happiness_Score)
  )
tail(select(data, Economy, Social, Health, Freedom, Corruption, Happiness_Score)
  )
```

*Summary statistics

*Box Plot
```{r}
data_long <- data %>%
  gather(key = "Variable", value = "Score", Economy, Social, Health, Freedom, Corruption) 

ggplot(data_long, aes(x = Variable, y = Score)) +
  geom_boxplot(width = 0.7) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(title = "Box Plot Each Variable", x = "Variables Affecting Happiness Score", y = "Values")
```


* Distribution of the values:
Corruption variable is narrowly distributed, mostly concentrated near the lower score values.

Economy variable has a broader distribution with more variability in scores. 

Freedom variable has a mid-range median and spread in values.

Health variable shows higher median happiness scores.

Social variable has widest range of scores.

* Outliers:
Corruption: Features multiple outliers at the lower end, which might represent instances where perceived corruption is significantly impacting happiness.

Social have a few lower outliers. Economy, freedom and health do not show clear outliers in this plot. 

* Inter-quartile Range (IQR):
Corruption shows a very tight IQR, close to the lower score limits. Economy, Freedom, and Health have moderately sized IQRs. Social has the largest IQR. 

*Violin Plot

```{r}
ggplot(data_long, aes(x = Variable, y = Score, fill = Variable)) +
  geom_violin(trim = TRUE) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(title = "Violin Plot of Each Variable", x = "Variables Affecting Happiness Score", y = "Values") +
  scale_fill_brewer(palette = "Pastel1")
```

* The Social and Health variables seem to have the most highest positive impact on happiness scores. Both variables are located inthe upper range. 
* Economy and Freedom shows less impact than the social and health variables. The variability in economic and freedom seems to impact the happiness score per situation.
* Corruption has high negative impact on happiness score, as the values are concentrated at the lower end of the plot. 
```


